import { CommandTypes } from '../enums/command-types.enum'
import { HistoryService } from '../service/history-service'
import { CommandRunner } from './command-runner'

export class NmapCommand extends CommandRunner {

  networkSweeping(ipRange: string) {
    const child = this.run('nmap', ['-sn', ipRange])
    const historyService = new HistoryService();
    let output = ''
    child.stdout.on('data', data => {
      output += data.toString()
    })
    child.stdout.on('close', () => {
      historyService.add(`nmap -sn ${ipRange}`, CommandTypes.NmapNetworkSweeping, output)
    })
  }
}