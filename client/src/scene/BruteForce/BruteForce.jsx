import axios from 'axios'
import React, { useEffect, useState } from 'react'
import { WordlistInput } from '../../components'


export function BruteForce() {

  const [tool, setTool] = useState('')
  const [mod, setMod] = useState('')
  const [wordlists, setWordlists] = useState([])
  const [host, setHost] = useState({})
  const [user, setUser] = useState({})
  const [password, setPassword] = useState({})

  useEffect(() => {
    axios.get('/api/wordlists')
      .then(({ data }) => setWordlists(data))
      .catch(err => console.log(err))
  }, [])

  function sendFile(e) {
    const formData = new FormData()
    formData.append('wordlist', e.target.files[0])
    axios.post('/api/upload', formData, {
      headers: {
        'Content-Type': 'multipart/form-data'
      }
    })
    e.target.value = null
  }

  function run() {
    console.log({ tool, mod, host, user, password })
  }

  return (
    <div>
      <h3>Brute Force</h3>
      <input type="radio" name="tool" value="medusa" onChange={e => setTool(e.target.value)} />
      <span style={{ fontSize: 14, marginLeft: 10 }}>Medusa</span>
      <br />
      <input type="radio" name="tool" value="hydra" onChange={e => setTool(e.target.value)} />
      <span style={{ fontSize: 14, marginLeft: 10 }}>Hydra</span>
      <span style={{ marginLeft: 160, marginRight: 10, fontSize: 14 }}>Module</span>
      <select onChange={e => setMod(e.target.value)}>
        <option>SSH</option>
        <option>FTP</option>
      </select>
      <div style={{ display: 'flex', flexDirection: 'row' }}>
        <WordlistInput onChange={e => setHost(e)} wordlists={wordlists} title="Host" />
        <WordlistInput onChange={e => setUser(e)} wordlists={wordlists} title="User" />
      </div>
      <WordlistInput onChange={e => setPassword(e)} wordlists={wordlists} title="Password" />
      <label htmlFor="files" className="btn">Import wordlist</label>
      <input id="files" style={{ visibility: 'hidden' }} onChange={e => sendFile(e)} type="file" />
      <button onClick={run}>Run</button>
    </div>
  )
}